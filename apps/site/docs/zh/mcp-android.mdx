import McpIntro from './common/mcp-intro.mdx';
import McpSharedTools from './common/mcp-shared-tools.mdx';
import McpReport from './common/mcp-report.mdx';

# Android MCP 服务

<McpIntro />

## 使用场景

- 在 Android 设备上执行自动化测试
- 操控 Android 应用完成 UI 交互
- 让 AI 助手直接控制 Android 设备

## 前提条件

1. **AI 模型服务**：OpenAI API 密钥或其他支持的 AI 模型服务。更多信息参见 [模型策略](./model-strategy)。

2. **Android 环境**：
   - 安装并配置 [Android adb](https://developer.android.com/tools/adb?hl=zh-cn) 工具
   - 将开启 USB 调试的 Android 设备或模拟器连接到电脑

## 配置

在 MCP 客户端中添加 Midscene Android MCP 服务器：

```json
{
  "mcpServers": {
    "midscene-android": {
      "command": "npx",
      "args": ["-y", "@midscene/android-mcp"],
      "env": {
        "MIDSCENE_MODEL_BASE_URL": "替换为你的模型服务地址",
        "MIDSCENE_MODEL_API_KEY": "替换为你的 API Key",
        "MIDSCENE_MODEL_NAME": "替换为你的模型名称",
        "MIDSCENE_MODEL_FAMILY": "替换为你的模型系列",
        "MCP_SERVER_REQUEST_TIMEOUT": "800000"
      }
    }
  }
}
```

更多 AI 模型配置参考 [模型策略](./model-strategy)。

## 可用工具

### Android 专属工具

| 工具名称 | 功能描述 |
|---------|---------|
| `android_connect` | 通过 ADB 连接 Android 设备 |
| `Launch` | 启动应用或打开 URL |
| `AndroidBackButton` | 触发系统返回键 |
| `AndroidHomeButton` | 触发系统主页键 |
| `AndroidRecentAppsButton` | 触发系统最近应用键 |
| `AndroidLongPress` | 长按屏幕指定位置 |
| `AndroidPull` | 下拉刷新或上拉操作 |
| `RunAdbShell` | 执行 ADB shell 命令 |

#### android_connect

通过 ADB 连接到某个 Android 设备。

```
参数：
- deviceId：（可选）要连接的设备 ID（来自 adb devices），默认为第一个可用设备
```

#### Launch

启动 Android 应用或打开 URL。

```
参数：
- param：应用包名或 URL
```

#### AndroidBackButton

触发系统返回键操作。

```
参数：无
```

#### AndroidHomeButton

触发系统主页键操作。

```
参数：无
```

#### AndroidRecentAppsButton

触发系统最近应用键操作。

```
参数：无
```

#### AndroidLongPress

在屏幕指定位置长按。

```
参数：
- locate：要长按的元素
- duration：（可选）长按持续时间（毫秒）
```

#### AndroidPull

下拉刷新或上拉操作。

```
参数：
- direction：拉动方向（'up' 或 'down'）
- distance：（可选）拉动距离（像素）
- duration：（可选）拉动持续时间（毫秒）
- locate：（可选）起始元素
```

#### RunAdbShell

执行 ADB shell 命令。

```
参数：
- param：要执行的 ADB shell 命令
```

<McpSharedTools />

## 常见问题

### ADB 连接问题

- 确保已安装 Android SDK 与 ADB
- Android 设备需开启开发者选项与 USB 调试
- 使用 `adb devices` 确认设备已连接

<McpReport />
