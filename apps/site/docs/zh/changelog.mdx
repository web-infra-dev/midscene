# æ›´æ–°æ—¥å¿—

> å®Œæ•´æ›´æ–°æ—¥å¿—è¯·å‚è€ƒï¼š[Midscene Releases](https://github.com/web-infra-dev/midscene/releases)

## v0.18.0 - å›æ”¾æŠ¥å‘ŠåŠŸèƒ½å¢å¼º

ğŸš€ Midscene åˆæœ‰æ›´æ–°å•¦ï¼ä¸ºä½ å¸¦æ¥é«˜è´¨é‡çš„ UI è‡ªåŠ¨åŒ–ä½“éªŒã€‚

### åœ¨æŠ¥å‘Šä¸­å¢åŠ è‡ªå®šä¹‰èŠ‚ç‚¹

* ä¸º agent æ·»åŠ  `logScreenshot` APIï¼Œå°†å½“å‰é¡µé¢çš„æˆªå›¾ä½œä¸ºæŠ¥å‘ŠèŠ‚ç‚¹ã€‚æ”¯æŒè®¾ç½®èŠ‚ç‚¹æ ‡é¢˜å’Œæè¿°ï¼Œä½¿æŠ¥å‘Šå†…å®¹æ›´åŠ ä¸°å¯Œã€‚é€‚ç”¨äºå…³é”®æ­¥éª¤æˆªå›¾è®°å½•ã€é”™è¯¯çŠ¶æ€æ•è·ã€UI éªŒè¯ç­‰ã€‚

![](/blog/logScreenshot-api.png)

* ç¤ºä¾‹ï¼š

```typescript
test('login github', async ({ ai, aiAssert, aiInput, logScreenshot }) => {
  if (CACHE_TIME_OUT) {
    test.setTimeout(200 * 1000);
  }
  await ai('Click the "Sign in" button');
  await aiInput('quanru', 'username');
  await aiInput('123456', 'password');

  // è‡ªå®šä¹‰è®°å½•
  await logScreenshot('Login page', {
    content: 'Username is quanru, password is 123456',
  });

  await ai('Click the "Sign in" button');
  await aiAssert('Login success');
});
```



### æ”¯æŒå°†æŠ¥å‘Šä¸‹è½½ä¸ºè§†é¢‘

* æ”¯æŒä»æŠ¥å‘Šæ’­æ”¾å™¨ç›´æ¥å¯¼å‡ºè§†é¢‘ï¼Œç‚¹å‡»æ’­æ”¾å™¨ç•Œé¢çš„ä¸‹è½½æŒ‰é’®å³å¯ä¿å­˜ã€‚

![](/blog/export-video.png)

* é€‚ç”¨åœºæ™¯ï¼šåˆ†äº«æµ‹è¯•ç»“æœã€å­˜æ¡£é‡ç°æ­¥éª¤ã€æ¼”ç¤ºé—®é¢˜å¤ç°



### Android æš´éœ²æ›´å¤šé…ç½®

* æ”¯æŒä½¿ç”¨è¿œç¨‹ adb ä¸»æœºï¼Œé…ç½®é”®ç›˜ç­–ç•¥

  * `autoDismissKeyboard?: boolean` - å¯é€‰å‚æ•°ï¼Œæ˜¯å¦åœ¨è¾“å…¥æ–‡æœ¬åè‡ªåŠ¨å…³é—­é”®ç›˜

  * `androidAdbPath?: string` - å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®š adb å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„

  * `remoteAdbHost?: string` - å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¿œç¨‹ adb ä¸»æœº

  * `remoteAdbPort?: number` - å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¿œç¨‹ adb ç«¯å£

* ç¤ºä¾‹ï¼š

```typescript
await agent.aiInput('æœç´¢æ¡†', 'æµ‹è¯•å†…å®¹', { autoDismissKeyboard: true })
```

```typescript
const agent = await agentFromAdbDevice('s4ey59', {
    autoDismissKeyboard: false, // å¯é€‰å‚æ•°ï¼Œæ˜¯å¦åœ¨è¾“å…¥æ–‡æœ¬åè‡ªåŠ¨å…³é—­é”®ç›˜ã€‚é»˜è®¤å€¼ä¸º trueã€‚
    androidAdbPath: '/usr/bin/adb', // å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®š adb å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„
    remoteAdbHost: '192.168.10.1', // å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¿œç¨‹ adb ä¸»æœº
    remoteAdbPort: '5037' // å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¿œç¨‹ adb ç«¯å£
})
```

ç«‹å³å‡çº§ç‰ˆæœ¬ï¼Œä½“éªŒè¿™äº›å¼ºå¤§æ–°åŠŸèƒ½ï¼

* [è‡ªå®šä¹‰æŠ¥å‘ŠèŠ‚ç‚¹ API æ–‡æ¡£](/zh/API.mdx#agentlogscreenshot)
* [Android æ›´å¤šé…ç½®é¡¹ API æ–‡æ¡£](/zh/integrate-with-android.mdx#androiddevice-%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)


## v0.17.4 - è®© AI çœ‹è§é¡µé¢ DOM

### æ•°æ®æŸ¥è¯¢ API å…¨é¢å¢å¼º

ä¸ºæ»¡è¶³æ›´å¤šè‡ªåŠ¨åŒ–å’Œæ•°æ®æå–åœºæ™¯ï¼Œä»¥ä¸‹ API æ–°å¢äº† options å‚æ•°ï¼Œæ”¯æŒæ›´çµæ´»çš„ DOM ä¿¡æ¯å’Œæˆªå›¾ä¼ é€’ï¼š

- `agent.aiQuery(dataDemand, options)`
- `agent.aiBoolean(prompt, options)`
- `agent.aiNumber(prompt, options)`
- `agent.aiString(prompt, options)`

#### æ–°å¢ `options` å‚æ•°

- `domIncluded`ï¼šæ˜¯å¦å‘æ¨¡å‹å‘é€ç²¾ç®€åçš„ DOM ä¿¡æ¯ï¼Œé»˜è®¤å€¼ä¸º falseã€‚ä¸€èˆ¬ç”¨äºæå– UI ä¸­ä¸å¯è§çš„å±æ€§ï¼Œæ¯”å¦‚å›¾ç‰‡çš„é“¾æ¥ã€‚
- `screenshotIncluded`ï¼šæ˜¯å¦å‘æ¨¡å‹å‘é€æˆªå›¾ã€‚é»˜è®¤å€¼ä¸º trueã€‚

#### ä»£ç ç¤ºä¾‹

```typescript
// æå–é€šè®¯å½•ä¸­æ‰€æœ‰è”ç³»äººçš„å®Œæ•´ä¿¡æ¯ï¼ˆåŒ…å«éšè—çš„å¤´åƒé“¾æ¥ï¼‰
const contactsData = await agent.aiQuery(
  "{name: string, id: number, company: string, department: string, avatarUrl: string}[], extract all contact information including hidden avatarUrl attributes",
  { domIncluded: true }
);

// æ£€æŸ¥é€šè®¯å½•ä¸­ç¬¬ä¸€ä¸ªè”ç³»äººçš„ id å±æ€§æ˜¯å¦ä¸º 1
const isId1 = await agent.aiBoolean(
  "Is the first contact's id is 1?",
  { domIncluded: true }
);

// è·å–ç¬¬ä¸€ä¸ªè”ç³»äººçš„ IDï¼ˆéšè—å±æ€§ï¼‰
const firstContactId = await agent.aiNumber("First contact's id?", { domIncluded: true });

// è·å–ç¬¬ä¸€ä¸ªè”ç³»äººçš„å¤´åƒ URLï¼ˆé¡µé¢ä¸Šä¸å¯è§çš„å±æ€§ï¼‰
const avatarUrl = await agent.aiString(
  "What is the Avatar URL of the first contact?",
  { domIncluded: true }
);
```

### æ–°å¢å³é”®ç‚¹å‡»èƒ½åŠ›

ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡éœ€è¦è‡ªåŠ¨åŒ–å³é”®æ“ä½œçš„åœºæ™¯ï¼Ÿç°åœ¨ï¼ŒMidscene æ”¯æŒäº†å…¨æ–°çš„ `agent.aiRightClick()` æ–¹æ³•ï¼

#### åŠŸèƒ½

ä½¿ç”¨å³é”®ç‚¹å‡»é¡µé¢å…ƒç´ ï¼Œé€‚ç”¨äºé‚£äº›è‡ªå®šä¹‰äº†å³é”®äº‹ä»¶çš„åœºæ™¯ã€‚æ³¨æ„ï¼šMidscene æ— æ³•ä¸æµè§ˆå™¨åŸç”Ÿèœå•äº¤äº’ã€‚

#### å‚æ•°è¯´æ˜

- `locate`: ç”¨è‡ªç„¶è¯­è¨€æè¿°ä½ è¦æ“ä½œçš„å…ƒç´ 
- `options`: å¯é€‰ï¼Œæ”¯æŒ `deepThink`ï¼ˆAIç²¾ç»†å®šä½ï¼‰ã€`cacheable`ï¼ˆç»“æœç¼“å­˜ï¼‰

#### ç¤ºä¾‹

```typescript
// åœ¨é€šè®¯å½•åº”ç”¨ä¸­å³é”®ç‚¹å‡»è”ç³»äººï¼Œè§¦å‘è‡ªå®šä¹‰ä¸Šä¸‹æ–‡èœå•
await agent.aiRightClick("Alice Johnson", { deepThink: true });

// ç„¶åå¯ä»¥ç‚¹å‡»èœå•ä¸­çš„é€‰é¡¹
await agent.aiTap("Copy Info"); // å¤åˆ¶è”ç³»äººä¿¡æ¯åˆ°å‰ªè´´æ¿
```


### ç¤ºä¾‹åŠå…¶æŠ¥å‘Š

#### ç¤ºä¾‹é¡µé¢

<iframe src="https://lf3-static.bytednsdoc.com/obj/eden-cn/nupipfups/Midscene/contacts3.html" width="100%" height="800"></iframe>

#### ç¤ºä¾‹æŠ¥å‘Š

<iframe src="https://lf3-static.bytednsdoc.com/obj/eden-cn/nupipfups/Midscene/puppeteer-2025-06-04_20-41-45-be8ibktz.html" width="100%" height="800"></iframe>


### ä¸€ä¸ªå®Œæ•´ç¤ºä¾‹

åœ¨ä¸‹é¢çš„æŠ¥å‘Šæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨æ–°çš„ `aiRightClick` API å’Œæ–°çš„æŸ¥è¯¢å‚æ•°æ¥æå–åŒ…å«éšè—å±æ€§çš„è”ç³»äººæ•°æ®ã€‚

æŠ¥å‘Šæ–‡ä»¶ï¼š[puppeteer-2025-06-04_20-41-45-be8ibktz.html](https://lf3-static.bytednsdoc.com/obj/eden-cn/nupipfups/Midscene/puppeteer-2025-06-04_20-41-45-be8ibktz.html)

å¯¹åº”ä»£ç å¯ä»¥å‚è€ƒæˆ‘ä»¬çš„ç¤ºä¾‹ä»“åº“ï¼š[puppeteer-demo/extract-data.ts](https://github.com/web-infra-dev/midscene-example/blob/main/puppeteer-demo/extract-data.ts)
