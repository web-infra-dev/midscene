{"version":3,"file":"scripts/water-flow.js","sources":["webpack://android-playground/./src/scripts/water-flow.ts"],"sourcesContent":["const midsceneWaterFlowAnimation = {\n  styleElement: null as null | HTMLStyleElement,\n\n  mousePointerAttribute: 'data-water-flow-pointer',\n\n  lastCallTime: 0,\n\n  cleanupTimeout: null as null | number,\n\n  // call to reset the self cleaning timer\n  registerSelfCleaning() {\n    // clean up all the indicators if there is no call for 30 seconds\n    this.lastCallTime = Date.now();\n    const cleaningTimeout = 30000;\n\n    if (this.cleanupTimeout) {\n      clearTimeout(this.cleanupTimeout);\n    }\n\n    this.cleanupTimeout = window.setTimeout(() => {\n      const now = Date.now();\n      if (now - this.lastCallTime >= cleaningTimeout) {\n        this.disable();\n      }\n    }, cleaningTimeout);\n  },\n\n  showMousePointer(x: number, y: number) {\n    this.enable(); // show water flow animation\n    this.registerSelfCleaning();\n    const existingPointer = document.querySelector(\n      `div[${this.mousePointerAttribute}]`,\n    ) as HTMLDivElement | null;\n\n    // Clear any existing timeouts to prevent race conditions\n    if (existingPointer) {\n      const timeoutId = Number(existingPointer.getAttribute('data-timeout-id'));\n      if (timeoutId) clearTimeout(timeoutId);\n      const removeTimeoutId = Number(\n        existingPointer.getAttribute('data-remove-timeout-id'),\n      );\n      if (removeTimeoutId) clearTimeout(removeTimeoutId);\n    }\n\n    const size = 30;\n    const pointer =\n      existingPointer ||\n      (() => {\n        const p = document.createElement('div');\n        p.setAttribute(this.mousePointerAttribute, 'true');\n        p.style.position = 'fixed';\n        p.style.width = `${size}px`;\n        p.style.height = `${size}px`;\n        p.style.borderRadius = '50%';\n        p.style.backgroundColor = 'rgba(0, 0, 255, 0.3)';\n        p.style.border = '1px solid rgba(0, 0, 255, 0.3)';\n        p.style.zIndex = '99999';\n        p.style.transition = 'all 1s ease-in';\n        p.style.pointerEvents = 'none'; // Make pointer not clickable\n        // Start from offset position if new pointer\n        p.style.left = `${x - size / 2}px`;\n        p.style.top = `${y - size / 2}px`;\n        document.body.appendChild(p);\n        return p;\n      })();\n\n    requestAnimationFrame(() => {\n      pointer.style.left = `${x - size / 2}px`;\n      pointer.style.top = `${y - size / 2}px`;\n      pointer.style.opacity = '1';\n    });\n\n    // Set new timeouts\n    const fadeTimeoutId = setTimeout(() => {\n      pointer.style.opacity = '0';\n      const removeTimeoutId = setTimeout(() => {\n        if (pointer.parentNode) {\n          document.body.removeChild(pointer);\n        }\n      }, 500);\n      pointer.setAttribute('data-remove-timeout-id', String(removeTimeoutId));\n    }, 3000);\n    pointer.setAttribute('data-timeout-id', String(fadeTimeoutId));\n  },\n\n  hideMousePointer() {\n    this.registerSelfCleaning();\n    const pointer = document.querySelector(\n      `div[${this.mousePointerAttribute}]`,\n    ) as HTMLDivElement | null;\n    if (pointer) {\n      document.body.removeChild(pointer);\n    }\n  },\n\n  enable() {\n    this.registerSelfCleaning();\n    if (this.styleElement) {\n      // double check if styleElement is still in the dom tree\n      if (document.head.contains(this.styleElement)) {\n        return;\n      }\n      this.styleElement = null;\n    }\n\n    this.styleElement = document.createElement('style');\n    this.styleElement.id = 'water-flow-animation';\n    this.styleElement.textContent = `\n    html::before {\n      content: \"\";\n      position: fixed;\n      top: 0; right: 0; bottom: 0; left: 0;\n      pointer-events: none;\n      z-index: 9999;\n      background:\n        linear-gradient(to right, rgba(30, 144, 255, 0.4), transparent 50%) left,\n        linear-gradient(to left, rgba(30, 144, 255, 0.4), transparent 50%) right,\n        linear-gradient(to bottom, rgba(30, 144, 255, 0.4), transparent 50%) top,\n        linear-gradient(to top, rgba(30, 144, 255, 0.4), transparent 50%) bottom;\n      background-repeat: no-repeat;\n      background-size: 10% 100%, 10% 100%, 100% 10%, 100% 10%;\n      animation: waterflow 5s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n      filter: blur(8px);\n    }\n\n    @keyframes waterflow {\n      0%, 100% {\n        background-image:\n          linear-gradient(to right, rgba(30, 144, 255, 0.4), transparent 50%),\n          linear-gradient(to left, rgba(30, 144, 255, 0.4), transparent 50%),\n          linear-gradient(to bottom, rgba(30, 144, 255, 0.4), transparent 50%),\n          linear-gradient(to top, rgba(30, 144, 255, 0.4), transparent 50%);\n        transform: scale(1);\n      }\n      25% {\n        background-image:\n          linear-gradient(to right, rgba(30, 144, 255, 0.39), transparent 52%),\n          linear-gradient(to left, rgba(30, 144, 255, 0.39), transparent 52%),\n          linear-gradient(to bottom, rgba(30, 144, 255, 0.39), transparent 52%),\n          linear-gradient(to top, rgba(30, 144, 255, 0.39), transparent 52%);\n        transform: scale(1.03);\n      }\n      50% {\n        background-image:\n          linear-gradient(to right, rgba(30, 144, 255, 0.38), transparent 55%),\n          linear-gradient(to left, rgba(30, 144, 255, 0.38), transparent 55%),\n          linear-gradient(to bottom, rgba(30, 144, 255, 0.38), transparent 55%),\n          linear-gradient(to top, rgba(30, 144, 255, 0.38), transparent 55%);\n        transform: scale(1.05);\n      }\n      75% {\n        background-image:\n          linear-gradient(to right, rgba(30, 144, 255, 0.39), transparent 52%),\n          linear-gradient(to left, rgba(30, 144, 255, 0.39), transparent 52%),\n          linear-gradient(to bottom, rgba(30, 144, 255, 0.39), transparent 52%),\n          linear-gradient(to top, rgba(30, 144, 255, 0.39), transparent 52%);\n        transform: scale(1.03);\n      }\n    }\n    `;\n    document.head.appendChild(this.styleElement);\n  },\n\n  disable() {\n    if (this.cleanupTimeout) {\n      clearTimeout(this.cleanupTimeout);\n      this.cleanupTimeout = null;\n    }\n\n    const styleElements = document.querySelectorAll('#water-flow-animation');\n    styleElements.forEach((element) => {\n      document.head.removeChild(element);\n    });\n    this.styleElement = null;\n\n    // remove all mouse pointers\n    const mousePointers = document.querySelectorAll(\n      `div[${this.mousePointerAttribute}]`,\n    );\n    mousePointers.forEach((element) => {\n      document.body.removeChild(element);\n    });\n  },\n};\n\nexport {};\ndeclare global {\n  interface Window {\n    midsceneWaterFlowAnimation: typeof midsceneWaterFlowAnimation;\n  }\n}\n(window as any).midsceneWaterFlowAnimation =\n  (window as any).midsceneWaterFlowAnimation || midsceneWaterFlowAnimation;\n(window as any).midsceneWaterFlowAnimation.enable();\n"],"names":["window","Date","clearTimeout","x","y","existingPointer","document","timeoutId","Number","removeTimeoutId","pointer","p","size","requestAnimationFrame","fadeTimeoutId","setTimeout","String","styleElements","element","mousePointers"],"mappings":"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"}